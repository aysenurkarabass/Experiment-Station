<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ay'ın Gizemli Yüzü Simülasyonu</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React ve ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel (JSX'i tarayıcıda çalıştırmak için) -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        /* React kodunda referans verilen özel scrollbar stilleri */
        .custom-scrollbar::-webkit-scrollbar {
            width: 8px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
            background: rgba(30, 41, 59, 0.5);
            border-radius: 4px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: rgba(71, 85, 105, 0.8);
            border-radius: 4px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: rgba(100, 116, 139, 1);
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        // React kancalarını React objesinden alıyoruz
        const { useState, useEffect, useRef, useCallback } = React;

        const MoonSimulation = () => {
            // Arayüz Durumu (Giriş Ekranı vs Simülasyon)
            const [showIntro, setShowIntro] = useState(true);

            // Simülasyon Durumları
            const [isPlaying, setIsPlaying] = useState(false);
            const [orbitSpeed, setOrbitSpeed] = useState(0.5); // Derece/frame
            
            // Tek bir zaman sayacı (tick) kullanarak senkronizasyonu garanti altına alıyoruz
            const [orbitAngle, setOrbitAngle] = useState(0); 
            const [rotationAngle, setRotationAngle] = useState(0);
            
            const [mode, setMode] = useState('locked'); // 'locked' | 'no-rotation' | 'manual'

            const requestRef = useRef();

            // Sabitler
            const ORBIT_RADIUS = 120;

            // Animasyon Döngüsü
            const animate = useCallback(() => {
                if (isPlaying) {
                setOrbitAngle(prevOrbit => {
                    const nextOrbit = prevOrbit + orbitSpeed;
                    
                    // KRİTİK DÜZELTME: Senkronizasyon Kilidi
                    if (mode === 'locked') {
                    setRotationAngle(nextOrbit); 
                    } else {
                    // Sabit dönme hızı (0.5) kullanıyoruz
                    const rotationSpeed = mode === 'no-rotation' ? 0 : 0.5;
                    setRotationAngle(prevRot => prevRot + rotationSpeed);
                    }
                    
                    return nextOrbit;
                });
                }
                requestRef.current = requestAnimationFrame(animate);
            }, [isPlaying, orbitSpeed, mode]);

            useEffect(() => {
                requestRef.current = requestAnimationFrame(animate);
                return () => {
                if (requestRef.current) cancelAnimationFrame(requestRef.current);
                };
            }, [animate]);

            // Senaryo Değiştiriciler
            const setScenario = (scenario) => {
                setIsPlaying(false);
                setOrbitAngle(0);
                setRotationAngle(0);
                setMode(scenario);
                
                setTimeout(() => {
                setOrbitSpeed(0.5);
                setIsPlaying(true);
                }, 50);
            };

            const resetSimulation = () => {
                setIsPlaying(false);
                setOrbitAngle(0);
                setRotationAngle(0);
                setMode('manual');
            };

            const apparentRotation = mode === 'locked' ? 0 : (rotationAngle - orbitAngle);

            // Gösterge için normalize edilmiş açılar (0-360 arası)
            const displayOrbitAngle = Math.round(orbitAngle % 360);
            const displayRotationAngle = Math.round(rotationAngle % 360);

            // --- GİRİŞ EKRANI (INTRO) - SIKIŞTIRILMIŞ VERSİYON KORUNDU ---
            if (showIntro) {
                return (
                <div className="flex flex-col items-center justify-center h-screen bg-slate-900 text-white p-4 font-sans overflow-hidden">
                    <div className="max-w-3xl w-full bg-slate-800 rounded-2xl shadow-2xl overflow-hidden border border-slate-700 flex flex-col max-h-[95vh]">
                    
                    {/* Logo ve Başlık Alanı - Padding azaltıldı */}
                    <div className="bg-white p-4 flex flex-col items-center border-b border-slate-700 shrink-0">
                        <img 
                        src="https://ogrenci.e12.com.tr/logo/tr/logo.svg" 
                        alt="Logo" 
                        className="h-10 mb-2" 
                        />
                        <h1 className="text-2xl font-bold text-blue-700 text-center">
                        Ay'ın Gizemli Yüzü Simülasyonu
                        </h1>
                        <p className="text-gray-600 mt-1 text-center text-sm">
                        Neden Ay'ın hep aynı yüzünü görürüz?
                        </p>
                    </div>

                    <div className="p-6 space-y-4 overflow-y-auto custom-scrollbar">
                        {/* Amaç Bölümü */}
                        <section>
                        {/* Başlık rengi düzeltildi: text-amber-400 -> text-white */}
                        <h2 className="text-lg font-bold text-white mb-2 flex items-center gap-2">
                            Simülasyonun Amacı
                        </h2>
                        <p className="text-slate-300 text-sm leading-relaxed">
                            Bu simülasyon, astronomideki en kafa karıştırıcı kavramlardan biri olan 
                            <strong> "Ay'ın Eş Zamanlı Dönüşü" (Kütleçekim Kilidi)</strong> olayını görselleştirmek için tasarlanmıştır. 
                            Amaç, Ay'ın kendi etrafında dönmesine rağmen Dünya'dan neden hep sabit göründüğünü, 
                            uzaydan ve Dünya'dan eş zamanlı bakış açılarıyla kanıtlamaktır.
                        </p>
                        </section>

                        {/* Nasıl Kullanılır Bölümü */}
                        <section>
                        {/* Başlık rengi düzeltildi: text-sky-400 -> text-white */}
                        <h2 className="text-lg font-bold text-white mb-2 flex items-center gap-2">
                            Nasıl Kullanılır?
                        </h2>
                        <div className="grid md:grid-cols-2 gap-3">
                            <div className="bg-slate-700/50 p-3 rounded-lg border border-slate-600">
                            <strong className="text-red-400 block mb-1 text-sm">1. Senaryo A (Yanlış Durum)</strong>
                            <p className="text-xs text-slate-300">
                                "Ay hiç dönmeseydi ne olurdu?" sorusunu test eder. Ay'ın kendi ekseni etrafında dönmediği durumda, Dünya'dan bakıldığında arka yüzünün de görüneceğini ispatlar.
                            </p>
                            </div>
                            <div className="bg-slate-700/50 p-3 rounded-lg border border-slate-600">
                            <strong className="text-green-400 block mb-1 text-sm">2. Senaryo B (Gerçek Durum)</strong>
                            <p className="text-xs text-slate-300">
                                Gerçek fiziksel durumu simüle eder. Ay'ın kendi etrafındaki dönüş süresi ile Dünya etrafındaki dolanma süresi eşitlenir. Sonuç: Dünya'ya hep aynı yüz bakar.
                            </p>
                            </div>
                        </div>
                        </section>

                        {/* Başlat Butonu - Padding azaltıldı, daha yukarı alındı */}
                        <div className="pt-2 flex justify-center pb-2">
                        <button 
                            onClick={() => setShowIntro(false)}
                            className="px-8 py-3 bg-blue-600 hover:bg-blue-500 text-white font-bold rounded-xl text-base transition-all transform hover:scale-105 shadow-lg shadow-blue-500/30"
                        >
                            Simülasyonu Başlat
                        </button>
                        </div>
                    </div>
                    </div>
                </div>
                );
            }

            // --- ANA SİMÜLASYON EKRANI ---
            return (
                <div className="flex flex-col h-screen bg-slate-900 text-white overflow-hidden font-sans">
                {/* Başlık - ORİJİNAL HALİNE GERİ DÖNDÜRÜLDÜ */}
                <header className="p-4 bg-white border-b border-gray-200 flex justify-between items-center shadow-md z-10 flex-shrink-0">
                    <div>
                    <h1 className="text-xl md:text-2xl font-bold text-blue-700 flex items-center gap-2">
                        Ay'ın Gizemli Yüzü Simülasyonu
                    </h1>
                    <p className="text-xs text-gray-600 mt-1">Neden Ay'ın hep aynı yüzünü görürüz?</p>
                    </div>
                    <div>
                    <img 
                        src="https://ogrenci.e12.com.tr/logo/tr/logo.svg" 
                        alt="Logo" 
                        className="h-8 md:h-12 object-contain"
                    />
                    </div>
                </header>

                {/* Ana İçerik - İkiye Bölünmüş Ekran */}
                <main className="flex-1 flex flex-col md:flex-row overflow-hidden">
                    
                    {/* SOL PANEL: UZAYDAN BAKIŞ (Kuşbakışı) */}
                    <div className="flex-1 bg-slate-900 relative border-r border-slate-700 flex flex-col">
                    <div className="absolute top-4 left-4 bg-slate-800/80 p-2 rounded text-sm border border-slate-600 z-10 pointer-events-none">
                        <h2 className="font-bold text-yellow-400">
                        Kuşbakışı (Uzay)
                        </h2>
                        <div className="text-xs text-slate-300 mt-1">
                        Dolanma Açısı: {displayOrbitAngle}°<br/>
                        Dönme Açısı: {displayRotationAngle}°
                        </div>
                    </div>

                    <div className="flex-1 flex items-center justify-center relative overflow-hidden">
                        {/* Yıldız Arka Planı */}
                        <div className="absolute inset-0 opacity-20" style={{backgroundImage: 'radial-gradient(circle, white 1px, transparent 1px)', backgroundSize: '30px 30px'}}></div>

                        {/* Simülasyon Alanı */}
                        <div className="relative w-[300px] h-[300px] md:w-[400px] md:h-[400px]">
                        
                        {/* Yörünge Çizgisi */}
                        <div className="absolute top-1/2 left-1/2 w-[240px] h-[240px] border border-dashed border-slate-500 rounded-full -translate-x-1/2 -translate-y-1/2 opacity-50"></div>

                        {/* DÜNYA */}
                        <div className="absolute top-1/2 left-1/2 w-16 h-16 -translate-x-1/2 -translate-y-1/2 z-20 bg-blue-500 rounded-full shadow-[0_0_20px_rgba(59,130,246,0.5)] flex items-center justify-center overflow-hidden">
                            <div className="w-full h-full bg-green-500/30 rounded-full absolute top-1 left-2 w-10 h-8 transform rotate-12"></div>
                            <div className="w-full h-full bg-green-500/30 rounded-full absolute bottom-2 right-3 w-6 h-6"></div>
                            <span className="relative z-10 text-[10px] font-bold text-white drop-shadow-md">DÜNYA</span>
                            
                            {/* Gözlemci Çocuğu Temsil Eden Nokta */}
                            <div className="absolute w-full h-1 bg-yellow-400/50 rotate-45 transform origin-center"></div>
                        </div>

                        {/* AY GRUBU (Dönme ve Konum) */}
                        <div 
                            className="absolute top-1/2 left-1/2 w-12 h-12 -translate-x-1/2 -translate-y-1/2 transition-transform duration-75 ease-linear will-change-transform z-30"
                            style={{
                            transform: `translate(-50%, -50%) rotate(${orbitAngle}deg) translate(${ORBIT_RADIUS}px) rotate(-${orbitAngle}deg)` 
                            }}
                        >
                            {/* AY OBJESİ (Kendi etrafında dönüşü) */}
                            <div 
                            className="w-full h-full rounded-full relative shadow-lg transition-transform duration-75 linear overflow-hidden"
                            style={{
                                transform: `rotate(${rotationAngle}deg)`,
                                background: 'linear-gradient(90deg, #cbd5e1 50%, #334155 50%)' 
                            }}
                            >
                            {/* ÖN YÜZ DETAYLARI */}
                            <div className="absolute top-1/2 left-[25%] -translate-y-1/2 flex flex-col items-center z-10">
                                <div className="w-0.5 h-4 bg-gray-900"></div>
                                <div className="w-3 h-2 bg-red-600 absolute top-0 left-0.5"></div>
                            </div>
                            <div className="absolute top-[20%] left-[10%] text-[5px] text-slate-800 font-bold rotate-90 opacity-70">
                                ÖN YÜZ
                            </div>

                            {/* ARKA YÜZ DETAYLARI */}
                            <div className="absolute top-1/2 right-[15%] -translate-y-1/2 text-[5px] text-white/70 font-mono font-bold rotate-90 text-center leading-tight">
                                ARKA<br/>YÜZ
                            </div>
                            </div>

                            <div className="absolute -top-6 left-1/2 -translate-x-1/2 text-[10px] text-white bg-black/50 px-1 rounded whitespace-nowrap">
                            Ay
                            </div>
                        </div>
                        </div>
                    </div>
                    
                    {/* Kontrol Paneli */}
                    <div className="bg-slate-800 p-4 border-t border-slate-700 flex-shrink-0">
                        <div className="flex flex-wrap gap-4 justify-center items-center mb-4">
                        {/* Senaryo A Butonu */}
                        <button 
                            onClick={() => setScenario('no-rotation')}
                            className={`flex flex-col items-center p-2 rounded-lg border-2 transition-all min-w-[100px] ${mode === 'no-rotation' ? 'border-red-500 bg-red-500/20 shadow-[0_0_15px_rgba(239,68,68,0.3)]' : 'border-slate-600 hover:bg-slate-700'}`}
                        >
                            <span className="font-bold text-sm">Senaryo A</span>
                            <span className="text-[10px] text-slate-300">Dönme Yok</span>
                        </button>

                        {/* Senaryo B Butonu */}
                        <button 
                            onClick={() => setScenario('locked')}
                            className={`flex flex-col items-center p-2 rounded-lg border-2 transition-all min-w-[100px] ${mode === 'locked' ? 'border-green-500 bg-green-500/20 shadow-[0_0_15px_rgba(34,197,94,0.3)]' : 'border-slate-600 hover:bg-slate-700'}`}
                        >
                            <span className="font-bold text-sm">Senaryo B (Gerçek)</span>
                            <span className="text-[10px] text-slate-300">Eş Zamanlı</span>
                        </button>

                        <div className="h-8 w-px bg-slate-600 mx-2"></div>

                        {/* Oynat/Sıfırla Butonları (Metin Tabanlı) */}
                        <div className="flex gap-2">
                            <button onClick={() => setIsPlaying(!isPlaying)} className="px-4 py-2 bg-blue-600 rounded hover:bg-blue-500 text-white transition-colors font-bold text-sm min-w-[80px]">
                            {isPlaying ? 'Durdur' : 'Oynat'}
                            </button>
                            <button onClick={resetSimulation} className="px-4 py-2 bg-slate-600 rounded hover:bg-slate-500 text-white transition-colors font-bold text-sm">
                            Sıfırla
                            </button>
                        </div>
                        </div>

                        {/* Slider */}
                        <div className="max-w-md mx-auto">
                        <div className="flex flex-col gap-1">
                            <label className="flex justify-between text-xs">
                            <span>Simülasyon Hızı</span>
                            <span className="text-blue-400">{orbitSpeed.toFixed(2)}x</span>
                            </label>
                            <input 
                            type="range" min="0" max="2" step="0.1" 
                            value={orbitSpeed} onChange={(e) => setOrbitSpeed(parseFloat(e.target.value))}
                            className="accent-blue-500 w-full"
                            />
                        </div>
                        </div>
                    </div>
                    </div>

                    {/* SAĞ PANEL: DÜNYA'DAN BAKIŞ (Pencere) */}
                    <div className="flex-1 bg-slate-800 relative flex flex-col border-l border-slate-700">
                    <div className="absolute top-4 left-4 bg-slate-900/80 p-2 rounded text-sm border border-slate-600 z-10 pointer-events-none">
                        <h2 className="font-bold text-green-400">
                        Pencereden Bakış
                        </h2>
                        <div className="text-xs text-slate-300 mt-1">
                        {mode === 'locked' 
                            ? <span className="text-green-400 font-bold">Ay Yüzü Sabit (Kilitli)</span>
                            : <span className="text-red-400">Ay Yüzü Değişiyor!</span>
                        }
                        </div>
                    </div>

                    {/* Pencere Çerçevesi */}
                    <div className="flex-1 flex items-center justify-center relative bg-sky-900/20">
                        {/* Pencere Kasası */}
                        <div className="relative w-[300px] h-[300px] border-[16px] border-slate-700 bg-black overflow-hidden rounded-lg shadow-inner group">
                        {/* Pencere Camı Yansıması */}
                        <div className="absolute inset-0 bg-gradient-to-tr from-transparent to-white/5 pointer-events-none z-20"></div>
                        
                        {/* Yıldızlar */}
                        <div className="absolute inset-0 opacity-50" style={{backgroundImage: 'radial-gradient(circle, white 1px, transparent 1px)', backgroundSize: '50px 50px', transform: `rotate(${orbitAngle * 0.1}deg)`}}></div>

                        {/* Görünen Ay */}
                        <div 
                            className="absolute top-1/2 left-1/2 w-48 h-48 rounded-full shadow-[0_0_30px_rgba(255,255,255,0.1)] transition-transform duration-75 linear"
                            style={{
                            transform: `translate(-50%, -50%) rotate(${apparentRotation}deg)`,
                            background: 'linear-gradient(90deg, #cbd5e1 50%, #334155 50%)' 
                            }}
                        >
                            {/* ÖN YÜZ (AYDINLIK) */}
                            <div className="absolute inset-0 rounded-full">
                                <div className="absolute top-1/2 left-[25%] -translate-y-1/2 flex flex-col items-center">
                                <div className="w-1 h-16 bg-gray-900"></div>
                                <div className="w-10 h-7 bg-red-600 absolute top-0 left-1 animate-pulse border border-white/20"></div>
                                </div>
                                <div className="absolute top-[30%] left-[15%] text-xs font-bold text-slate-700 -rotate-90">
                                ÖN YÜZ
                                </div>
                                <div className="absolute top-1/4 left-[30%] w-6 h-6 bg-slate-400/30 rounded-full"></div>
                                <div className="absolute bottom-1/4 left-[20%] w-8 h-8 bg-slate-400/30 rounded-full"></div>
                            </div>

                            {/* ARKA YÜZ (KARANLIK) */}
                            <div className="absolute inset-0 rounded-full pointer-events-none">
                                <div className="absolute top-1/2 right-[15%] -translate-y-1/2 text-center">
                                    <span className="block text-2xl font-bold text-white/20 mb-1">?</span>
                                    <span className="text-[10px] text-white/40 font-mono tracking-widest rotate-90 block">ARKA YÜZ</span>
                                </div>
                                <div className="absolute top-[20%] right-[30%] w-4 h-4 bg-black/20 rounded-full"></div>
                                <div className="absolute bottom-[30%] right-[25%] w-5 h-5 bg-black/20 rounded-full"></div>
                            </div>
                        </div>
                        </div>

                        {/* Çocuk Silüeti (Solda) */}
                        <div className="absolute left-0 top-1/2 -translate-y-1/2 w-24 h-64 bg-slate-900 z-30 rounded-r-full opacity-90 blur-[1px] pointer-events-none"></div>
                        <div className="absolute left-0 top-1/2 -translate-y-1/2 w-20 h-56 bg-black z-30 rounded-r-full flex justify-end items-center pr-4 text-slate-500 text-xs pointer-events-none shadow-2xl border-r border-slate-800">
                        <span className="-rotate-90 whitespace-nowrap font-bold tracking-wider opacity-70">GÖZLEMCİ</span>
                        </div>
                    </div>

                    {/* Açıklama Paneli */}
                    <div className="p-4 bg-slate-800 border-t border-slate-700 flex-shrink-0">
                        <div className="flex items-start gap-3">
                        <div>
                            <h3 className="font-bold text-white mb-1">Durum Analizi</h3>
                            <p className="text-sm text-white leading-normal">
                            {mode === 'no-rotation' ? (
                                <React.Fragment>
                                <strong className="block mb-1 text-base text-red-400">SENARYO A: Ay Dönmüyor!</strong>
                                Pencereye bakın! Ay kendi ekseni etrafında dönmediği için, Dünya etrafında tur attıkça bize sürekli farklı taraflarını gösteriyor. 
                                <br/><br/>
                                Bir an "Ön Yüzü", biraz sonra "Arka Yüzü" görüyorsunuz. Bu, Ay'ın gerçek hareketi değildir.
                                </React.Fragment>
                            ) : mode === 'locked' ? (
                                <React.Fragment>
                                <strong className="block mb-1 text-base text-green-400">SENARYO B: Gerçek Durum</strong>
                                Pencereye bakın! Ay'ın <strong>sadece "Ön Yüzünü" ve Bayrağı</strong> görüyorsunuz. Arka yüz hiç görünmüyor.
                                <br/><br/>
                                Bunun sebebi, Ay'ın kendi etrafında dönme süresi ile Dünya etrafında dolanma süresinin <strong>tamamen eşit</strong> olmasıdır.
                                </React.Fragment>
                            ) : (
                                <span className="text-yellow-400">
                                <strong>MANUEL MOD:</strong> Hızları siz kontrol ediyorsunuz. Eşitliği bozarsanız arka yüzü görmeye başlarsınız.
                                </span>
                            )}
                            </p>
                        </div>
                        </div>
                    </div>
                    </div>

                </main>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<MoonSimulation />);
    </script>
</body>
</html>